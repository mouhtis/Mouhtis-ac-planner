<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mouhtis HVAC Suite</title>

<!-- Firebase compat (Î³Î¹Î± GitHub Pages) -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

<style>
  :root{
    --bg:#f5f7fa;
    --card:#ffffff;
    --border:#e5e7eb;
    --text:#111827;
    --muted:#6b7280;
    --accent:#0b74de;
    --accent-dark:#095fb6;
    --accent-soft:#dbeafe;
    --sidebar-bg:#0d1b2a;
    --sidebar-bg2:#1b263b;
  }

  *{box-sizing:border-box;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;}

  body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
  }

  /* LOGIN */
  #loginScreen {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: radial-gradient(circle at top,#e0f2fe,#f5f6fa);
    z-index: 9999;
  }
  #loginScreen h1 {
    font-size: 26px;
    margin-bottom: 10px;
    color: var(--accent);
  }
  #loginScreen .subtitle{
    font-size:13px;
    color:var(--muted);
    margin-bottom:18px;
  }
  #loginPass {
    padding: 10px 12px;
    width: 240px;
    border-radius: 10px;
    border: 1px solid #d1d5db;
    font-size: 15px;
    text-align:center;
  }
  #loginPass:focus{
    outline:none;
    border-color:var(--accent);
    box-shadow:0 0 0 1px var(--accent-soft);
  }
  #loginBtn {
    padding: 8px 18px;
    margin-top: 12px;
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 999px;
    cursor: pointer;
    font-weight:600;
  }
  #loginBtn:hover { background: var(--accent-dark); }

  /* SIDEBAR */
  .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    width: 230px;
    height: 100vh;
    background: var(--sidebar-bg);
    color: white;
    padding-top: 20px;
  }
  .sidebar h2 {
    text-align: center;
    margin-bottom: 16px;
    font-weight: 600;
    font-size:18px;
  }
  .menu-btn {
    width: 90%;
    margin: 6px auto;
    padding: 10px 12px;
    background: var(--sidebar-bg2);
    color: white;
    border: none;
    border-radius: 8px;
    text-align: left;
    cursor: pointer;
    display:flex;
    align-items:center;
    gap:8px;
    font-size:14px;
  }
  .menu-btn span.icon{width:20px;text-align:center;}
  .menu-btn:hover {
    background: #415a77;
  }
  .menu-btn.active{
    background:#415a77;
  }

  /* MAIN */
  .main {
    margin-left: 250px;
    padding: 20px 18px 40px;
    max-width:1100px;
  }
  h1 {
    margin: 0 0 6px 0;
    font-size:22px;
  }
  h2{margin:0 0 8px 0;font-size:18px;}
  h3{margin:0 0 6px 0;font-size:15px;}
  .subtitle{
    font-size:13px;
    color:var(--muted);
    margin-bottom:10px;
  }

  .card {
    background: var(--card);
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 18px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    border:1px solid var(--border);
  }

  .btn {
    padding: 8px 16px;
    background: var(--accent);
    color: white;
    border-radius: 999px;
    border: none;
    cursor: pointer;
    margin: 4px 4px 4px 0;
    font-weight: 600;
    font-size:13px;
  }
  .btn:hover { background: var(--accent-dark); }
  .btn.secondary{
    background:#fff;
    color:var(--accent);
    border:1px solid var(--accent-soft);
  }
  .btn.secondary:hover{
    background:var(--accent-soft);
  }
  .btn.small{font-size:12px;padding:5px 10px;}

  label{
    display:block;
    font-size:12px;
    color:var(--muted);
    margin-top:6px;
    margin-bottom:2px;
  }
  input, select, textarea{
    width:100%;
    padding:7px 9px;
    border-radius:8px;
    border:1px solid var(--border);
    font-size:13px;
    outline:none;
  }
  textarea{resize:vertical;min-height:60px;}
  input:focus, select:focus, textarea:focus{
    border-color:var(--accent);
    box-shadow:0 0 0 1px var(--accent-soft);
    background:#fff;
  }

  .search-box {
    padding: 9px 12px;
    width: 100%;
    max-width: 400px;
    border-radius: 999px;
    border: 1px solid #d1d5db;
    margin-bottom: 10px;
    font-size:13px;
  }

  .muted{font-size:12px;color:var(--muted);}

  table{
    width:100%;
    border-collapse:collapse;
    font-size:13px;
  }
  th,td{
    padding:6px 4px;
    border-bottom:1px solid #e5e7eb;
    text-align:left;
  }
  th{
    font-size:12px;
    color:var(--muted);
    font-weight:600;
  }

  .link{
    font-size:12px;
    color:var(--accent);
    cursor:pointer;
  }
  .link:hover{text-decoration:underline;}

  @media(max-width: 800px){
    .sidebar{
      position:relative;
      width:100%;
      height:auto;
    }
    .main{
      margin-left:0;
      padding:14px 12px 28px;
    }
  }
</style>
</head>

<body>

<!-- LOGIN SCREEN -->
<div id="loginScreen">
  <h1>Mouhtis HVAC Suite</h1>
  <div class="subtitle">Î•Î¯ÏƒÎ¿Î´Î¿Ï‚ Î¼Îµ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚.</div>
  <input id="loginPass" type="password" placeholder="ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚" />
  <button id="loginBtn">Î•Î¯ÏƒÎ¿Î´Î¿Ï‚</button>
</div>

<!-- SIDEBAR -->
<div class="sidebar">
  <h2>Menu</h2>
  <button class="menu-btn active" data-page="customers">
    <span class="icon">ğŸ‘¤</span> Î ÎµÎ»Î¬Ï„ÎµÏ‚
  </button>
  <button class="menu-btn" data-page="tasks">
    <span class="icon">ğŸ› ï¸</span> Î•ÏÎ³Î±ÏƒÎ¯ÎµÏ‚
  </button>
  <button class="menu-btn" data-page="project">
    <span class="icon">ğŸ“</span> Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î­ÏÎ³Î¿Ï…
  </button>
  <button class="menu-btn" data-page="study">
    <span class="icon">ğŸ“</span> ÎœÎµÎ»Î­Ï„Î· ÎºÎ»Î¹Î¼Î±Ï„Î¹ÏƒÎ¼Î¿Ï
  </button>
</div>

<!-- MAIN AREA -->
<div class="main" id="mainContent">
  <h1>Mouhtis HVAC Suite</h1>
  <div class="subtitle">Î•Ï€Î¯Î»ÎµÎ¾Îµ ÎµÎ½ÏŒÏ„Î·Ï„Î± Î±Ï€ÏŒ Ï„Î¿ Î±ÏÎ¹ÏƒÏ„ÎµÏÏŒ Î¼ÎµÎ½Î¿Ï.</div>
  <div class="card">
    <h3>Î‘ÏÏ‡Î¹ÎºÎ®</h3>
    <div class="muted">Î•Î´Ï Î¸Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏÎ½Î¿ÏˆÎ· ÏŒÏ„Î±Î½ Î¿Î»Î¿ÎºÎ»Î·ÏÏÏƒÎ¿Ï…Î¼Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÎµÎ½ÏŒÏ„Î·Ï„ÎµÏ‚.</div>
  </div>
</div>

<script>
/* ------------ LOGIN ------------ */
const loginBtn = document.getElementById("loginBtn");
loginBtn.onclick = () => {
  const pass = document.getElementById("loginPass").value.trim();
  if (pass === "fgb0911+") {
    document.getElementById("loginScreen").style.display = "none";
  } else {
    alert("Î›Î¬Î¸Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚");
  }
};

/* ------------ FIREBASE (compat) ------------ */
const firebaseConfig = {
  apiKey: "AIzaSyAJlPDZktoQmDUIwQrCBsH_GLEhn5N6owE",
  authDomain: "mouhtis-suite.firebaseapp.com",
  projectId: "mouhtis-suite",
  storageBucket: "mouhtis-suite.firebasestorage.app",
  messagingSenderId: "1093547214312",
  appId: "1:1093547214312:web:83cc116f17b031f2ef105d",
  measurementId: "G-84HEW3XYX1"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* ------------ STATE ------------ */
let customers = [];

/* ------------ HELPERS ------------ */
function $(sel){return document.querySelector(sel);}
function $all(sel){return Array.from(document.querySelectorAll(sel));}

/* ------------ CUSTOMERS CRUD ------------ */
async function loadCustomers(){
  try{
    const snap = await db.collection("customers").orderBy("createdAt","desc").get();
    customers = snap.docs.map(d=>({id:d.id, ...d.data()}));
    renderCustomerList();
  }catch(e){
    console.error("Error loading customers", e);
  }
}

function renderCustomerList(){
  const wrap = $("#customers_list");
  if(!wrap) return;
  const q = ($("#customers_search")?.value || "").toLowerCase();
  let arr = customers.slice();
  if(q){
    arr = arr.filter(c =>
      (c.name||"").toLowerCase().includes(q) ||
      (c.phone||"").toLowerCase().includes(q) ||
      (c.address||"").toLowerCase().includes(q) ||
      (c.area||"").toLowerCase().includes(q) ||
      (c.email||"").toLowerCase().includes(q)
    );
  }
  if(!arr.length){
    wrap.innerHTML = '<div class="muted">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚.</div>';
    return;
  }
  let html = '<table><thead><tr><th>ÎŒÎ½Î¿Î¼Î±</th><th>Î¤Î·Î»Î­Ï†Ï‰Î½Î¿</th><th>Î ÎµÏÎ¹Î¿Ï‡Î®</th><th>Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·</th><th></th></tr></thead><tbody>';
  arr.forEach(c=>{
    html += `<tr>
      <td>${c.name||""}</td>
      <td>${c.phone||""}</td>
      <td>${c.area||""}</td>
      <td>${c.address||""}</td>
      <td><span class="link" data-del="${c.id}">Î”Î¹Î±Î³ÏÎ±Ï†Î®</span></td>
    </tr>`;
  });
  html += '</tbody></table>';
  wrap.innerHTML = html;

  $all('[data-del]').forEach(el=>{
    el.onclick = ()=> deleteCustomer(el.getAttribute('data-del'));
  });
}

async function saveCustomer(){
  const name = $("#c_name").value.trim();
  const phone = $("#c_phone").value.trim();
  const email = $("#c_email").value.trim();
  const address = $("#c_address").value.trim();
  const area = $("#c_area").value.trim();
  const notes = $("#c_notes").value.trim();
  const msgEl = $("#c_msg");
  if(!name){
    msgEl.textContent = "Î£Ï…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎµ Ï„Î¿Ï…Î»Î¬Ï‡Î¹ÏƒÏ„Î¿Î½ ÏŒÎ½Î¿Î¼Î±.";
    return;
  }
  msgEl.textContent = "Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·...";
  try{
    const data = {
      name, phone, email, address, area, notes,
      createdAt: firebase.firestore.FieldValue.serverTimestamp()
    };
    const ref = await db.collection("customers").add(data);
    customers.unshift({id:ref.id, ...data});
    msgEl.textContent = "Î‘Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ.";
    clearCustomerForm(false);
    renderCustomerList();
  }catch(e){
    console.error(e);
    msgEl.textContent = "Î£Ï†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·.";
  }
}

function clearCustomerForm(clearMsg=true){
  $("#c_name").value="";
  $("#c_phone").value="";
  $("#c_email").value="";
  $("#c_address").value="";
  $("#c_area").value="";
  $("#c_notes").value="";
  if(clearMsg) $("#c_msg").textContent="";
}

async function deleteCustomer(id){
  if(!confirm("ÎÎ± Î´Î¹Î±Î³ÏÎ±Ï†ÎµÎ¯ Î¿ Ï€ÎµÎ»Î¬Ï„Î·Ï‚;")) return;
  try{
    await db.collection("customers").doc(id).delete();
    customers = customers.filter(c=>c.id!==id);
    renderCustomerList();
  }catch(e){
    console.error(e);
    alert("Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î´Î¹Î±Î³ÏÎ±Ï†Î®.");
  }
}

/* ------------ PAGE RENDERING ------------ */
function loadPage(page){
  const main = document.getElementById("mainContent");
  let html = "";

  if(page==="customers"){
    html = `
      <h1>Î ÎµÎ»Î¬Ï„ÎµÏ‚</h1>
      <div class="subtitle">ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· & Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Ï€ÎµÎ»Î±Ï„ÏÎ½ (cloud Firestore).</div>

      <div class="card">
        <h3>ÎÎ­Î¿Ï‚ Ï€ÎµÎ»Î¬Ï„Î·Ï‚</h3>
        <label>ÎŸÎ½Î¿Î¼Î±Ï„ÎµÏ€ÏÎ½Ï…Î¼Î¿</label>
        <input id="c_name" placeholder="Ï€.Ï‡. Î“Î¹Î¬Î½Î½Î·Ï‚ Î Î±Ï€Î±Î´ÏŒÏ€Î¿Ï…Î»Î¿Ï‚"/>

        <label>Î¤Î·Î»Î­Ï†Ï‰Î½Î¿</label>
        <input id="c_phone" placeholder="69xxxxxxx"/>

        <label>Email</label>
        <input id="c_email" placeholder="example@mail.com"/>

        <label>Î ÎµÏÎ¹Î¿Ï‡Î®</label>
        <input id="c_area" placeholder="Ï€.Ï‡. Î¤Î¿ÏÎ¼Ï€Î±"/>

        <label>Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·</label>
        <input id="c_address" placeholder="ÎŸÎ´ÏŒÏ‚, Î±ÏÎ¹Î¸Î¼ÏŒÏ‚"/>

        <label>Î£Ï‡ÏŒÎ»Î¹Î±</label>
        <textarea id="c_notes" placeholder="Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚ Î³Î¹Î± Ï‡ÏÏÎ¿, Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·, Ï‰ÏÎ¬ÏÎ¹Î± ÎºÎ»Ï€."></textarea>

        <div style="margin-top:10px;">
          <button class="btn small" id="c_save_btn">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
          <button class="btn secondary small" id="c_clear_btn">ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚</button>
        </div>
        <div id="c_msg" class="muted" style="margin-top:4px;"></div>
      </div>

      <div class="card">
        <h3>Î›Î¯ÏƒÏ„Î± Ï€ÎµÎ»Î±Ï„ÏÎ½</h3>
        <input id="customers_search" class="search-box" placeholder="Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· (ÏŒÎ½Î¿Î¼Î±, Ï„Î·Î», Ï€ÎµÏÎ¹Î¿Ï‡Î®, Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·, email)..."/>
        <div id="customers_list" class="muted">Î¦ÏŒÏÏ„Ï‰ÏƒÎ·...</div>
      </div>
    `;
    main.innerHTML = html;

    document.getElementById("c_save_btn").onclick = saveCustomer;
    document.getElementById("c_clear_btn").onclick = ()=>clearCustomerForm(true);
    document.getElementById("customers_search").oninput = renderCustomerList;

    loadCustomers();
  }

  if(page==="tasks"){
    html = `
      <h1>Î•ÏÎ³Î±ÏƒÎ¯ÎµÏ‚</h1>
      <div class="subtitle">Î— ÎµÎ½ÏŒÏ„Î·Ï„Î± Î¸Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ Î¼Îµ Firestore ÏƒÎµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î²Î®Î¼Î±.</div>
      <div class="card">
        <h3>Î›Î¯ÏƒÏ„Î± ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½</h3>
        <div class="muted">Î ÏÎ¿Ï‚ Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ·.</div>
      </div>
    `;
    main.innerHTML = html;
  }

  if(page==="project"){
    html = `
      <h1>Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î­ÏÎ³Î¿Ï…</h1>
      <div class="subtitle">Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÎºÏŒÏƒÏ„Î¿Ï…Ï‚ Î­ÏÎ³Ï‰Î½ (Î¸Î± Ï…Î»Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î¼ÎµÏ„Î¬).</div>
      <div class="card">
        <h3>ÎˆÏÎ³Î±</h3>
        <div class="muted">Î ÏÎ¿Ï‚ Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ·.</div>
      </div>
    `;
    main.innerHTML = html;
  }

  if(page==="study"){
    html = `
      <h1>ÎœÎµÎ»Î­Ï„Î· ÎºÎ»Î¹Î¼Î±Ï„Î¹ÏƒÎ¼Î¿Ï</h1>
      <div class="subtitle">ÎœÎµÎ»Î­Ï„Î· BTU & Ï€ÏÎ¿Ï„Î¬ÏƒÎµÎ¹Ï‚ ÎºÎ»Î¹Î¼Î±Ï„Î¹ÏƒÏ„Î¹ÎºÏÎ½ (Ï…Ï€ÏŒ ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î®).</div>
      <div class="card">
        <h3>ÎšÎ¬Ï„Î¿ÏˆÎ·</h3>
        <input type="file" />
        <div class="muted" style="margin-top:6px;">Î¤Î¿ upload ÎµÎ¯Î½Î±Î¹ Î¼ÏŒÎ½Î¿ Î³Î¹Î± ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ„Î¬Î´Î¹Î¿.</div>
      </div>
    `;
    main.innerHTML = html;
  }

  $all(".menu-btn").forEach(btn=>{
    btn.classList.toggle("active", btn.getAttribute("data-page")===page);
  });
}

/* ------------ MENU BIND ------------ */
$all(".menu-btn").forEach(btn=>{
  btn.addEventListener("click", ()=> {
    const page = btn.getAttribute("data-page");
    loadPage(page);
  });
});
</script>

</body>
</html>
